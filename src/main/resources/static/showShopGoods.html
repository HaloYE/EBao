<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>店铺商品</title>
    <link rel="stylesheet" href="layuiadmin/layui/css/layui.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/Business.css">
    <script src="js/x-layui.js"></script>
    <script src="layuiadmin/layui/layui.js"></script>
    <script src="js/jquery-3.5.1.min.js"></script>
    <style>
        .layui-table-cell{
            height: auto;
            width: auto;
        }
    </style>
</head>
<body>
<div class="container1"></div>
<div class="container2">
    <div class="x-body">
        <form class="layui-form x-center" style="width:800px;margin-left: 25%">
            <div class="layui-form-pane" style="margin-top: 15px">
                <div class="layui-form-item">
                    <div class="layui-input-inline">
                        <input type="text" name="goodsId" id="goodsId" placeholder="商品id模糊查询" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-input-inline">
                        <input type="text" name="goodsName" id="goodsName" placeholder="商品名称模糊查询" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-input-inline" style="width:80px">
                        <button class="layui-btn" type="button" onclick="searchGoodsBtn()"><i class="layui-icon">&#xe615;</i></button>
                    </div>
                </div>
            </div>
        </form>
        <xblock>
            <button class="layui-btn" onclick="goods_add('添加商品','goodsAdd.html','1000','600')">
                <i class="layui-icon">&#xe608;</i>添加商品
            </button>
        </xblock>
        <table class="layui-table" id="demo" lay-filter="demo">
        </table>
        <!--        <script type="text/html" id="barDemo">
                    <a title="编辑" href="javascript:;" onclick="pro_edit('编辑','pro_add.html','2','1000','600')"
                       class="ml-5" style="text-decoration:none">
                        <i class="layui-icon">&#xe642;</i>
                    </a>
                    <a title="删除" href="javascript:;" onclick="pro_del(this,'2')"
                       style="text-decoration:none">
                        <i class="layui-icon">&#xe640;</i>
                    </a>
                </script>-->
        <script type="text/html" id="barDemo">
            {{#  if(d.status==1){ }}
                <button class="layui-btn layui-btn-xs"
                        class="ml-5" style="text-decoration:none" lay-event="urge">
                    <i class="layui-icon">&#xe626;</i>催一催
                </button>
            {{#  } else { }}
                <button class="layui-btn layui-btn-xs"
                        class="ml-5" style="text-decoration:none" lay-event="editGoods">
                    <i class="layui-icon">&#xe66e;</i>修改信息
                </button>
                <button class="layui-btn layui-btn-xs"
                        class="ml-5" style="text-decoration:none" lay-event="delGoods">
                    <i class="layui-icon">&#xe640;</i>删除商品
                </button>
            {{#  } }}
        </script>
        <div id="page"></div>
        <script type="text/html" id="Goodsstatus">
            {{#  if(d.status==1){ }}
            <span style="color: red">出租中</span>
            {{#  } else { }}
            <span style="color: green">闲置中</span>
            {{#  } }}
        </script>
    </div>
</div>
<div class="container3"></div>
</body>
<script>
    var table;
    var $;
    layui.use(['table','jquery'], function(){
        table = layui.table;
        $=layui.jquery;

        var shopId=localStorage.getItem("shopId");
        table.render({
            elem:'#demo',
            url:'../eBao/selectShopGoods.action?shopId='+shopId,
            page:true,
            cols:[[
                // {type:'checkbox', fixed: 'left'}
                {field: 'goodsId', title: 'ID',width: 130}
                ,{field: 'goodsName', title: '商品名称',width: 130}
                ,{field: 'goodsKind', title: '商品种类',width: 180}
                ,{field: 'shopsId', title: '所属店铺',width: 130}
                ,{field: 'goodsPrice', title: '价格',width: 125}
                ,{field: 'deposit', title: '押金',width: 130}
                ,{field: 'status', title: '状态',templet:"#Goodsstatus",width: 130}
                ,{field: 'work', title: '操作', toolbar: '#barDemo',width: 200}
            ]]
        })
        table.on('tool(demo)', function(obj){ //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的 DOM 对象（如果有的话）

            if(layEvent === 'urge'){ //催一催
                layer.msg('以提醒顾客，请耐心等待', {icon: 1});
            } else if(layEvent === 'editGoods'){ //修改信息


            } else if(layEvent === 'delGoods'){ //删除信息
                layer.confirm('确定要删除这个商品吗',function () {
                    title: '删除商品'
                    ,$.post(
                        "../eBao/deleteOneGoods.action?goodsId="+data.goodsId
                    );
                    location.reload();
                })

            } else if(layEvent === 'LAYTABLE_TIPS'){
                layer.alert('Hi，头部工具栏扩展的右侧图标。');
            }

        });
    });

    function searchGoodsBtn(){
        // alert($("#shopName").val())
        table.reload("demo",{where:
                {
                    goodsId: $("#goodsId").val()
                    ,goodsName: $("#goodsName").val()
                }});
    }

    function shop_add(title,url,width,height){
        layer.open({
            title: title
            ,type:2
            ,content: url
            ,area:[width+'px',height+'px']
            ,maxmin: true
        });
    }
</script>
</html>