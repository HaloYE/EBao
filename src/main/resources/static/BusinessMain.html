<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>商家主界面</title>
    <script src="layuiadmin/layui/layui.js"></script>
    <script src="js/jquery.min.js"></script>
    <link rel="stylesheet" href="layuiadmin/layui/css/layui.css">
    <link rel="stylesheet" href="css/bootstrap.css">
    <script src="js/x-layui.js"></script>
    <link rel="stylesheet" href="css/Business.css">
</head>
<body>
<div class="container1"></div>
<div class="container2">
    <div class="x-body">
        <form class="layui-form x-center" style="width:800px;margin-left: 20%">
            <div class="layui-form-pane" style="margin-top: 15px">
                <div class="layui-form-item">
                    <label class="layui-form-label">日期范围</label>
                    <div class="layui-input-inline">
                        <input class="layui-input" placeholder="开始日" id="LAY_demorange_s">
                    </div>
                    <div class="layui-input-inline">
                        <input class="layui-input" placeholder="截止日" id="LAY_demorange_e">
                    </div>
                    <div class="layui-input-inline">
                        <input type="text" name="username"  placeholder="标题" autocomplete="off" class="layui-input">
                    </div>
                    <div class="layui-input-inline" style="width:80px">
                        <button class="layui-btn"  lay-submit="" lay-filter="sreach"><i class="layui-icon">&#xe615;</i></button>
                    </div>
                </div>
            </div>
        </form>
        <xblock>
            <button class="layui-btn layui-btn-danger" onclick="delAll()">
                <i class="layui-icon">&#xe640;</i>批量删除店铺
            </button>
            <button class="layui-btn" onclick="park_add('添加车位','park_add.html','1000','600')">
                <i class="layui-icon">&#xe608;</i>添加新店铺
            </button>
            <button class="layui-btn" onclick="park_add('添加车位','park_add.html','1000','600')">
                <i class="layui-icon">&#xe608;</i>添加租赁商品
            </button>
            <!--        <span class="x-right" style="line-height:40px">共有数据：<span class="layui-badge">4</span> 条</span>-->
        </xblock>
        <table class="layui-table" id="demo">
        </table>
        <script type="text/html" id="barDemo">
            <a title="编辑" href="javascript:;" onclick="pro_edit('编辑','pro_add.html','2','1000','600')"
               class="ml-5" style="text-decoration:none">
                <i class="layui-icon">&#xe642;</i>
            </a>
            <a title="删除" href="javascript:;" onclick="pro_del(this,'2')"
               style="text-decoration:none">
                <i class="layui-icon">&#xe640;</i>
            </a>
        </script>
        <div id="page"></div>
    </div>
</div>
<div class="container3"></div>

<script>
    var table;
    layui.use('table', function(){
        table = layui.table;

        table.render({
            elem:'#demo',
            url:'../selectShop.action',
            page:true,
            cols:[[
                {type:'checkbox', fixed: 'left'}
                ,{field: 'shopId', title: '店铺ID', }
                ,{field: 'shopName', title: '店铺名称'}
                ,{field: 'address', title: '地址'}
                ,{field: 'work', title: '操作', toolbar: '#barDemo'}
            ]],
            // data: [{"shopId":"sp001","shopName":"巫家小店","address":"常州工学院"}]
        })
    });
</script>
<script>
    function delAll(){
        var checkStatus = table.checkStatus('demo')
        var data = checkStatus.data;
        var str =""
        $.each(data,function (i,n){
            str=str+n.id+","
        });

        /*   $.map(data,function (){
               return this.id;
           }).join(",")*/
        $.ajax({
            url:"/ssmTest/deleteParking.action",
            dataType:"json",
            data:{ids:str},
            success:function (msg){
                table.reload('demo');
            }
        })
    }
    function park_add(title,url,width,height){
        layer.open({
            title: title
            ,type:2
            ,content: url
            ,area:[width+'px',height+'px']
            ,maxmin: true
        });
    }
    $("#x-body").on("click", ".Parkingstatus", function () {
        if ($(this).text() === "使用中") {
            var child=$(this).parents("tr").children();
            var id=child.eq(2).text();
            location="${pageContext.request.contextPath}/turnParkingStatus.action?id="+id+"&status="+d.status;
            $(this).text("闲置中");
            $(this).removeClass("layui-btn-danger");
            $(this).addClass("layui-btn-normal")
        } else {
            var child=$(this).parents("tr").children();
            var id=child.eq(2).text();
            location="${pageContext.request.contextPath}/turnParkingStatus.action?id="+id+"&status="+d.status;
            $(this).text("使用中");
            $(this).removeClass("layui-btn-normal");
            $(this).addClass("layui-btn-danger");
        }
    });
</script>
</body>
</html>