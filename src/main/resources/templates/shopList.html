<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org">
<head>
    <meta charset="UTF-8">
    <title>E宝交易网</title>
    <link rel="icon" th:href="@{/images/logo.png}" th:type="@{/image/x-icon}">
    <link rel="stylesheet" th:href="@{/css/shopList.css}">
    <script type="text/javascript" th:src="@{/js/jquery-3.5.1.min.js}" th:inline="javascript"></script>
    <script type="text/javascript" th:src="@{http://lib.sinaapp.com/js/jquery/1.7.2/jquery.min.js}"></script>
    <script type="text/javascript"
            th:src="@{http://api.map.baidu.com/api?v=2.0&ak=LQq0W9wA7A54GQ2fRd6YgpvDG14nX1K7}"></script>
    <script type="text/javascript" th:src="@{http://developer.baidu.com/map/jsdemo/demo/convertor.js}"></script>
    <script type="text/javascript" th:src="@{/js/jquery.cookie.js}"></script>
    <script th:src="@{../static/js/jquery-1.11.0.min.js}"></script>
    <link rel="stylesheet" th:href="@{https://cdn.bootcss.com/twitter-bootstrap/3.3.7/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{http://jrain.oscitas.netdna-cdn.com/tutorial/css/fontawesome-all.min.css}">
    <script th:src="@{https://cdn.bootcss.com/twitter-bootstrap/3.3.7/js/bootstrap.min.js}"></script>
</head>

<body>
<div class="big_container">
    <!--导航栏-->
    <iframe th:src="@{/index/navigation.html}" width="100%" height="100%" style=" height: 120px" frameborder="0"
            scrolling="no" name="headFrame"></iframe>
    <!--主要内容-->
    <div class="container">
        <div class="shop_list">
            <!--分类查看-->
            <div class="select">
                <div class="title">
                    <span style="font-family: 微软雅黑;font-size: 15px">分类查看：</span>
                    <div class="menu_container">
                        <div class="row">
                            <div class="vertical-tab" role="tabpanel">
                                <!-- Nav tabs -->

                                <ul class="nav nav-tabs" role="tablist">
                                    <!--                                                th:href="@{/shoplist?&shopType=${shop.shopType}}"-->
                                    <li value="1" class="shopType" role="presentation">
                                        <a aria-controls="home" role="tab"
                                           data-toggle="tab">住房服务</a>                                            </a>
                                    </li>
                                    <li value="2" class="shopType" role="presentation"><a aria-controls="profile"
                                                                                          role="traffic"
                                                                                          data-toggle="tab">交通工具</a>
                                    </li>
                                    <li value="3" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                          role="family"
                                                                                          data-toggle="tab">居家生活</a>
                                    </li>
                                    <li value="4" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                          role="equiment"
                                                                                          data-toggle="tab">设备仪器</a>
                                    </li>
                                    <li value="5" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                          role="machine"
                                                                                          data-toggle="tab">机械设备</a>
                                    </li>
                                    <li value="6" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                          role=""
                                                                                          data-toggle="tab">建材物资</a>
                                    </li>
                                    <li value="7" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                          role="tab"
                                                                                          data-toggle="tab">文体用品</a>
                                    </li>
                                    <li value="8" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                          role="tab"
                                                                                          data-toggle="tab">办公用品</a>
                                    </li>
                                    <li value="9" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                          role="tab"
                                                                                          data-toggle="tab">婚庆用品</a>
                                    </li>
                                    <li value="10" class="shopType" role="presentation"><a aria-controls="messages"
                                                                                           role="tab"
                                                                                           data-toggle="tab">节日用品</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--商家列表-->
            <div class="shop">
                <div class="shop_container">
                    <div class="title_container">
                        <li class="title" style="float: left;font-family: 微软雅黑;font-size: 15px">当前位置：<span
                                id="nowlocation"></span></li>
                        <li class="title" style="float: right;font-family: 微软雅黑;font-size: 15px"><a
                                th:href="@{./test2.html}"><span
                                style="font-family: 微软雅黑;font-size: 15px;text-decoration: none">查看地图</span></a></li>
                    </div>
                    <table th:each="shop:${shoplist}">
                        <tr>
                            <div class="list">
                                <div class="list_container">
                                    <div class="shop_pic">
                                        <img th:src="@{/images/Reindeer.png}" height="100%" width="100%"
                                             style="border-radius: 50%"/>
                                    </div>
                                    <div class="shop_text">
                                        <div class="shop_name">
                                            <!--商店名称-->
                                            <span style="color:#17A4C7" th:text="${shop.shopName}"></span>
                                        </div>
                                        <div class="shop_service">
                                            <!--服务范围-->
                                            <span style="font-size: 2px" th:text="${shop.businessId}"></span>
                                        </div>
                                        <div class="shop_service1">
                                            <!--服务简介-->
                                            <span th:text="${shop.address}"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="list_cover">
                                    <div class="shop_detail">
                                        <input type="button" class="detail" value="查看详情" th:data-id="${shop.shopId}"
                                               onclick="toSecondKind(this.getAttribute('data-id'))">
                                        <!--&lt;!&ndash;                                        th:data-id="${user.username}" onclick="goUserinfo(this.getAttribute('data-id'))"-->
                                        <!--                                        th:onclick="|javascript:toSecondKind('${shop.shopId}')|"-->
                                    </div>
                                </div>
                            </div>
                        </tr>
                    </table>
                </div>
            </div>
            <!--分页查看-->
            <div class="page">
                <div>
                    <div class="page_context">
                        <span th:text="'第'+(${pageNo})+'页'" class="page_text"></span>
                    </div>
                    <div class="page_context">
                        <a th:href="@{/shopList(pageNo=1)}" class="page_text">首页</a>
                    </div>
                    <div class="page_context">
                        <span id="firstPage" class="page_text"><a th:href="@{/shopList(pageNo=${pageNo}-1)}"
                                                                  class="page_text">上一页</a></span>
                        <!--                         th:if="${pageNo}!=1"class="page_text"-->
                    </div>
                    <div class="page_context">
                        <span id="lastPage" class="page_text"><a
                                th:href="@{/shopList(pageNo=${pageNo}+1)}">下一页</a></span>
                        <!--                         th:if="${pageNo}!=${pages}"-->
                    </div>
                    <div class="page_context">
                        <a th:href="@{/shopList(pageNo=${pages})}" class="page_text">尾页</a>
                    </div>
                    <div class="page_context">
                        <span th:text="'共'+(${pages})+'页'|" class="page_text"></span>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
</div>

</div>
<!--底部栏-->
<iframe th:src="@{/index/footer.html}" width="100%" height="100%" frameborder="0" scrolling="no"
        style="height: 300px;display: block"></iframe>
</div>

<!--首页后分类商铺界面定位-->
<!--<script th:src="@{/js/categoriesLocation.js}" th:inline="javascript"></script>-->
<script>
    $(function () {
        /*        if(supportsGeoLocation()){
                    alert("你的浏览器支持 GeoLocation.");
                }else{
                    alert("不支持 GeoLocation.")
                }
                // 检测浏览器是否支持HTML5
                function supportsGeoLocation(){
                    return !!navigator.geolocation;
                }*/

        // 单次位置请求执行的函数
        function getLocation() {
            navigator.geolocation.getCurrentPosition(mapIt, locationError);
        }

        //定位成功时，执行的函数
        function mapIt(position) {
            var lon = position.coords.longitude;
            var lat = position.coords.latitude;
            // alert("您位置的经度是："+lon+" 纬度是："+lat);
            var map = new BMap.Map("allmap");
            var point = new BMap.Point("" + lon + "", "" + lat + "");
            var gc = new BMap.Geocoder();
            translateCallback = function (point) {
                gc.getLocation(point, function (rs) {
                    var addComp = rs.addressComponents;
                    if (addComp.province !== addComp.city) {
                        document.getElementById("nowlocation").innerHTML = addComp.province + ", " + addComp.city + ", " + addComp.district;
                        // document.getElementById("nowlocation").innerHTML = "当前位置："+addComp.province + ", " + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber;
                    } else {
                        document.getElementById("nowlocation").innerHTML = addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber;
                        // document.getElementById("nowlocation").innerHTML = "当前位置：" + addComp.city + ", " + addComp.district + ", " + addComp.street + ", " + addComp.streetNumber;
                    }

                });
            }
            BMap.Convertor.translate(point, 0, translateCallback);
        }

        // 定位失败时，执行的函数
        function locationError(error) {
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    alert("User denied the request for Geolocation.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert("Location information is unavailable.");
                    break;
                case error.TIMEOUT:
                    alert("The request to get user location timed out.");
                    break;
                case error.UNKNOWN_ERROR:
                    alert("An unknown error occurred.");
                    break;
            }
        }

        // 页面加载时执行getLocation函数
        window.onload = getLocation();
    })

</script>
<script>
    $(function () {
        $(".shopType").click(function () {
            var shopType = $(this).attr("value");
            console.log(shopType)
            if (shopType == 1) {
                // alert(shopType)
                var goodsFirstKind = "住房"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 2) {
                // alert(shopType)
                var goodsFirstKind = "交通工具"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 3) {
                // alert(shopType)
                var goodsFirstKind = "居家"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 4) {
                // alert(shopType)
                var goodsFirstKind = "设备仪器"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 5) {
                // alert(shopType)
                var goodsFirstKind = "机械"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 6) {
                // alert(shopType)
                var goodsFirstKind = "建材"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 7) {
                // alert(shopType)
                var goodsFirstKind = "文体"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 8) {
                // alert(shopType)
                var goodsFirstKind = "办公"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 9) {
                // alert(shopType)
                var goodsFirstKind = "婚庆"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            } else if (shopType == 10) {
                // alert(shopType)
                var goodsFirstKind = "节日"
                localStorage.setItem("TheShopFirstKind", goodsFirstKind);
                location.href = "../eBao/shopList?goodsFirstKind=" + goodsFirstKind
            }
        })


    })

    function toSecondKind(shopId) {
        var goodsFirstKind = localStorage.getItem("TheShopFirstKind");
        var theGoodsFirstKind = $.trim(goodsFirstKind);
        localStorage.setItem("theShopId", shopId)
        console.log(shopId);
        console.log(goodsFirstKind);
        console.log(theGoodsFirstKind);
        switch (theGoodsFirstKind) {
            case "住房":
                location.href = "../eBao/housecommodityindex?shopId="+shopId;
                break;
            case "交通工具":
                location.href = "../eBao/carcommodityindex?shopId="+shopId;
                break;
            case "居家":
                location.href = "../eBao/homecommodityindex?shopId="+shopId;
                break;
            case "设备仪器":
                location.href = "../eBao/equipcommodityindex?shopId="+shopId;
                break;
            case "机械":
                location.href = "../eBao/machinecommodityindex?shopId="+shopId;
                break;
            case "建材":
                location.href = "../eBao/buildcommodityindex?shopId="+shopId;
                break;
            case "文体":
                location.href = "../eBao/recreationcommodityindex?shopId="+shopId;
                break;
            case "办公":
                location.href = "../eBao/officecommodityindex?shopId="+shopId;
                break;
            case "婚庆":
                location.href = "../eBao/weddingcommodityindex?shopId="+shopId;
                break;
            case "节日":
                location.href = "../eBao/festivalcommodityindex?shopId="+shopId;
                break;

        }
    }
</script>
<script>
    // var name = $.cookie('name');
    // alert(name);
</script>
</body>
</html>